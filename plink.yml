docs:
  - filename: "OpenROV Controller 2.8 Final Data Pkg/Gerber Files/OpenROV Controller 2.8.G2L"
    handler:
      name: "Gerber" # the step handler creates a part with type as the file name (if type is not specified)
      config:
        type: "Inner Copper 2" # this is the vector "type" that will be created. 
      
# the assembly tree
# instatiates assemblies and parts
tree:
  - name: "OpenROV Controller 2.8" 
  
# defines types of assemblies
assemblies:
  - type: "OpenROV Controller 2.8"
    subassemblies:
      - name: "OpenROV Controller 2.8 PCB"
    parts: [] # will get filled in from BOM

    # stackup. layer data will be filled with a fab step. (silimar to how laser cut parts will work)
  - type: "OpenROV Controller 2.8 PCB"
    subassemblies:
      # std stackup for 4-layer http://www.4pcb.com/pcb-stack-ups-0.062.html
      - name: "Top Stack"
      - name: "Bottom Stack"
    parts:
      - name: "Core"
        type: "FR4 40mil Prepreg"
        
  # will need to fix this global namespace somehow...
  - type: "Top Stack"
    parts:
      - name: "Top Paste"
      - name: "Top Silk"
      - name: "Top Mask"
      - name: "Top Copper"
      - name: "Sheet 1"
        type: "FR4 2116"
      - name: "Sheet 2"
        type: "FR4 2116"
      - name: "Inner Copper 2"
        
  - type: "Bottom Stack"
    parts:
      - name: "Inner Copper 3"
      - name: "Sheet 1"
        type: "FR4 2116"
      - name: "Sheet 2"
        type: "FR4 2116"
      - name: "Bottom Copper"
      - name: "Bottom Mask"
      - name: "Bottom Silk"
      - name: "Bottom Paste"
  
# this is a list of fabrications. a fabrication take a part(s) or assembl(ies) (any thing that implments "cad.Thing") as an input and produces a Thing as an output.
# examples would a piece of raw sheet plastic (from a source) and laser cut using a DXF file to produce a solid. (e.g. most of the pieces in the OpenROV cad)
fabrications:
  - name: "Top Stack"
    inputs:
      - class: "vectors"
        name: "Top Paste"
      - class: "vectors"
        name: "Top Silk"
      - class: "vectors"
        name: "Top Mask"
      - class: "vectors"
        name: "Top Copper"
      - class: "vectors"
        name: "Inner Copper 2" 
        
    outputs:
      - class: "assembly"
        type: "Top Stack"

    fabricator:
      name: "pcb scad"
      params:
        stackup:
          tpaste: "Top Paste"
          tsilk: "Top Silk"
          tmask: "Top Mask"
          tcopper: "Top Copper"
          core:
            t: 8
            u: "mil"
          bcopper: "Inner Copper 2"

  - name: "Bottom Stack"
    inputs:
      - class: "vectors"
        name: "Inner Copper 3" 
      - class: "vectors"
        name: "Bottom Copper" 
      - class: "vectors"
        name: "Bottom Mask"
      - class: "vectors"
        name: "Bottom Silk" 
      - class: "vectors"
        name: "Bottom Paste"
        
    outputs:
      - class: "assembly"
        type: "Bottom Stack"

    fabricator:
      name: "pcb scad"
      params:
        npt-drill: "OpenROV 2.8 Controller Drill"
        stackup:
          tpaste: "Top Paste"
          tsilk: "Top Silk"
          tmask: "Top Mask"
          tcopper: "Top Copper"
          core:
            t: 8
            u: "mil"
            material: "FR4"
          bcopper: "Inner Copper 2"

  - name: "FR4 40mil Prepreg"
    outputs:
      - class: "part"
        type: "FR4 40mil Prepreg"
    fabricator:
      name: "pcb scad"
      params:
        stackup:
          core:
            t: 40
            u: "mil"
            material: "FR4"